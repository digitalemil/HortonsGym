<html>
<head>
<script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js?lang=css&skin=sunburst"></script></head>
<body bgcolor="#69be28">

<h2>Welcome to Horton's Gym!</h2>
<h3>In this part of the tutorial we will install the server part of Horton's Gym on your Mac.</h3>
<b>Requirements:<p>A Mac with at least 8GB of RAM and roughly 20GB free diskspace.</p>
<p>VMWare Fusion</p>
<p><a href="http://hortonassets.s3.amazonaws.com/2.2/Sandbox_HDP_2.2.4_VMWare.ova">Hortonworks HDP 2.2.4-2 Sandbox</a></p>
<p><a href="http://mirror.softaculous.com/apache/tomcat/tomcat-7/v7.0.61/bin/apache-tomcat-7.0.61.tar.gz">Tomcat</a></p>
<p><a href="https://www.dropbox.com/s/upi3424jspeqohr/ROOT.war?dl=0">Horton's Gym WAR-File</a></p>
<p><a href="https://github.com/digitalemil/HDPDemoStudio.git">Access to HDPDemoStudio</a></p>
<p><a href="https://www.dropbox.com/s/fr1xht0e33vaghd/BananaDashboard.json?dl=0">Banana Dashboard</a></p>
<p><a href="https://www.dropbox.com/s/8onxz195yobh7i2/hr.pmml?dl=0">PMML</a></p><br>


<h3>Let's get started.</h3>
1. Logon to your Mac and fire up VMware Fusion. Then import the sandbox (Sandbox_HDP_2.2.4_VMWare.ova) via File->Import:
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym0.jpg"></p>
2. Save the VM in a folder of your choice:
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym1.jpg"></p>
3. Have a cup of coffee while Fusion is importing the VM:
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym2.jpg"></p>
4. When this is done your screen should like this:
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym3.jpg"></p>
5. Let's modify the RAM & Core settings. 4GB should work but more is better. Same with the cores:
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym4.jpg"></p>
6. No let's start the VM and take note of the IP address of the VM:
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym5.jpg"></p>
7. Then add the ip to your /etc/hosts file on your Mac:
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym6.jpg"></p>
8. Copy <a href="HortonsGymStormTopology-2.2.4.2-2-distribution.jar">Copy HortonsGymStormTopology-2.2.4.2-2-distribution.jar to /root on your VM:</a>
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym8.jpg"></p>
9. Afterwards ssh to your sandbox via ssh root@sandbox and then start cloning the git repo from HDPDemoStudio:
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym9.jpg"></p>
10. cd into the HDPDemoStudio folder and modify install.sh
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym10.jpg"></p>
11. Make the maven install command a comment as we won't use Atlas with the Horton's Gym context.
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym11.jpg"></p>
12. Execute the install.sh script:
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym12.jpg"></p>
13. When it's done your screen should look like the one on the screenshot below. It's important to know that Horton's Gym needs a exactly matching version of the HDP sandbox. At the time I'm writing this it is version 2.2.4.2-2. You can verify this by checking ls -al /usr/hdp/2.2.4.2-2/ on your VM.
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym13.jpg"></p>
14. The install script started Ambari and needed services. Check the Ambari UI if all services are up and running:
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym14.jpg"></p>
15. Now create the application: sh ./createapp.sh HortonsGym samples/hortonsgym.properties
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym15.jpg"></p>
16. A start script has been created which we need to modify a bit:
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym16.jpg"></p>
17. Go to the end of the script where it deploys the storm topology:
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym17.jpg"></p>
18. Make the following changes: Point it to the jar file you copied to the VM at step 8 and change true to false. When commit is set to true each incoming heartrate is commited within Solr which is a bit too heavy for the sandbox. When set to false a commit happens every 24th heartrate.
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym18.jpg"></p>
19. Execute the script:
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym19.jpg"></p>
20. When done you should see this:
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym20.jpg"></p>
21. Now back to your Mac. Extract tomcat, remove everything in webapps, deploy HortonsGym's WAR file and start tomcat. The IP address and port tomcat is binding to is what you need to enter into your iOS app. E.g. http://10.0.1.7:8080 (Assuming 10.0.1.7 is the ip from your Mac and is accessible from  your phone. 8080 would be the http port in your tomcat's server config)) 
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym21.jpg"></p>
22. Installation completed! Bring up the UI:
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym22.jpg"></p>
23. Put up a chest-strap and start ingesting data:
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym23.jpg"></p>
24. Back on your VM do a quick tail -f /var/log/storm/Horton*log<br>
You should see incoming messages and how they are digested by Storm:
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym24.jpg"></p>
25. Load the Banana Dashboard and anaylze the messages:
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym25.jpg"></p>
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym26.jpg"></p>
26. Upload the PMML model:
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym27.jpg"></p>
27. Watch how the model changes it's color depending on the evaulation of the model
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym28.jpg"></p>
<p><img src="http://digitalemil.de/hortonsgym/res/hortonsgym29.jpg"></p>
Done!


<!--
<pre class="prettyprint">
source code here
</pre>
-->

</body>
</html>

 